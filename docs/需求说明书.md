# MagicAlbum 需求说明书（初稿）

版本：v0.1 初稿  
状态：草案  
更新日期：2025-12-21

## 1. 概述
- MagicAlbum 是一个以“分区-帖子-回复”为核心的轻社区/相册式论坛，支持基础的发布、浏览、搜索与互动。
- 当前目标：完成里程碑 1 的核心功能与基础联调，支持分区列表、发帖、查询与分页，预留后续扩展。

## 2. 目标与非目标
- 目标
  - 支持分区管理与列表浏览（查询/分页）。
  - 支持创建帖子（发帖），并在分区内展示帖子列表与详情。
  - 支持基础鉴权（登录/注册），前端携带 `Authorization` 访问受限接口。
  - 提供 RESTful API 规范与数据库模型，便于联调与迭代。
  - 完成基本测试计划（单元/集成/API/E2E）以保障质量。
- 非目标（里程碑 1 不包含）
  - 富文本/Markdown 高级编辑器与附件大规模上传优化。
  - 复杂的权限系统（角色层级、细粒度资源访问控制）。
  - 消息通知、推荐算法、运营后台等增值功能。

## 3. 用户角色
- 访客：可浏览公开分区与帖子；可搜索；不能发帖与回复。
- 注册用户：在登录后可发帖与回复，未来可点赞/收藏。
- 管理员：可管理分区与内容（发布、隐藏、置顶等）。

## 4. 核心功能清单
1) 分区（Section）
   - 列表查询：支持关键字 `q`、分页 `page/size`、可选排序 `sort`。
   - 详情获取：根据 `id` 或 `slug` 获取分区信息。
   - 管理操作（管理员）：创建/更新/隐藏（里程碑 2）。
2) 帖子（Thread）
   - 创建：登录态下选择分区、填写标题与内容发布。
   - 列表：按分区或全站维度查询，支持分页与搜索。
   - 详情：展示帖子内容与基础元信息。
3) 回复（Post/Comment）（里程碑 2 可选）
   - 在帖子下回复，支持楼层/引用（后续迭代）。
4) 鉴权（Auth）
   - 注册、登录、Profile；前端存储 `accessToken` 并随请求头传递。

## 5. 关键用例
- 用例 UC-01：用户在分区列表页输入关键字，查看分页结果。
- 用例 UC-02：用户打开“发帖”页，选择分区、填写标题与内容后发布。
- 用例 UC-03：用户在帖子详情页查看帖子内容及后续回复（后续里程碑）。
- 用例 UC-04：管理员创建新的分区并维护其元信息（后续里程碑）。

## 6. 业务流程（示例：发帖）
1) 已登录用户进入发帖页；前端加载分区下拉。
2) 用户填写分区、标题与内容；前端校验必填项。
3) 前端向 `POST /api/v1/threads` 发送请求；成功后提示“发布成功”。

## 7. 功能性需求细则
- 分区列表：
  - 接口支持 `q`（模糊匹配名称/描述）、`page`、`size`、`sort`。
  - 响应支持两种结构：
    - 纯数组 `Section[]`；或分页对象 `{ items: Section[], page, size, total }`。
- 发帖：
  - 字段要求：`sectionId`、`title`、`content` 必填。
  - 仅登录用户可发帖；后端校验并返回帖子实体或成功状态。
- 错误处理：
  - 返回 JSON 含 `message`、可选 `code`；前端显示用户可理解的提示。

## 8. 非功能性需求
- 性能：分页查询响应在 200ms（P95）内；发布在 500ms（P95）内。
- 可用性：服务可用性 99%；出现错误时提供可读提示。
- 兼容性：前端支持现代浏览器最新两个大版本；移动端适配基础布局。
- 安全性：密码加密存储（BCrypt/Argon2）；JWT 有效期与刷新策略；输入内容进行基本过滤防 XSS。

## 9. 约束与假设
- 技术栈：前端 Vue3+Vite+Tailwind；后端 Java（Spring Boot 设定），数据库使用关系型（PostgreSQL 或 MySQL）。
- 环境：前端 Node.js ≥ 20.18；后端 JDK ≥ 17；Docker Compose 可选。
- 数据规范：ID 使用雪花/自增，时间统一使用 UTC 存储。

## 10. 里程碑与范围
- 里程碑 1：分区列表（搜索/分页）、发帖、基础鉴权、API 与数据模型初版、测试计划初版。
- 里程碑 2：帖子详情与回复、管理员分区管理、点赞/收藏、监控与日志增强。

---